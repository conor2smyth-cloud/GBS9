<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Premium Listings - GBS9</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="js/header.js" defer></script>
</head>
<body>
  <header id="site-header"></header>

  <main class="content-wrapper">
    <h1>Premium Listings</h1>

<div class="intro" style="margin-bottom:2rem; text-align:center; color:#ddd;">
  <p>‚ú® Welcome to our Premium Listings!  
  Click any drink to learn more, or ‚ù§Ô∏è swipe right/add to favourites to save it to your favourites menu in 'Build your Menu'.  
  Use the filters on the right to refine your search.</p>
</div>


    <section id="cocktails">
      <h2>üç∏ Cocktails</h2>
      <div class="grid" id="cocktailGrid"></div>
    </section>

    <section id="beer">
      <h2>üç∫ Beer</h2>
      <div class="grid" id="beerGrid"></div>
    </section>

    <section id="equipment">
      <h2>‚öôÔ∏è Equipment</h2>
      <div class="grid" id="equipmentGrid"></div>
    </section>
  </main>

<script>
async function loadListings() {
  try {
    const res = await fetch('data/cocktails.json');
    const data = await res.json();

    const cocktailGrid = document.getElementById('cocktailGrid');
    const beerGrid = document.getElementById('beerGrid');
    const equipmentGrid = document.getElementById('equipmentGrid');
    const modal = document.getElementById("modal");
    const modalImg = document.getElementById("modalImg");
    const modalTitle = document.getElementById("modalTitle");
    const modalDesc = document.getElementById("modalDesc");
    const modalDetails = document.getElementById("modalDetails");
    const closeBtn = document.querySelector(".close");

    function createCard(item, type) {
      if (item.image === "coming-soon.jpg") return "";
      return `
        <div class="card" data-type="${type}" data-name="${item.name}">
          <img src="images/${type}/${item.image}" alt="${item.name}" 
               onerror="this.src='images/coming-soon.jpg'">
          <h3>${item.name}</h3>
          <p>${item.short || ''}</p>
          <button class="fav-btn">‚ù§Ô∏è Add to Favourites</button>
        </div>
      `;
    }

    cocktailGrid.innerHTML = data.cocktails.map(drink => createCard(drink, "cocktails")).join("");
    beerGrid.innerHTML = data.beer.map(drink => createCard(drink, "beer")).join("");
    equipmentGrid.innerHTML = data.equipment.map(eq => createCard(eq, "equipment")).join("");

    // Delegation for card clicks (modal)
    document.body.addEventListener("click", function(e) {
      const card = e.target.closest(".card");
      if (card && !e.target.classList.contains("fav-btn")) {
        const type = card.getAttribute("data-type");
        const name = card.getAttribute("data-name");
        let item;

        if (type === "cocktails") {
          item = data.cocktails.find(d => d.name === name);
        } else if (type === "beer") {
          item = data.beer.find(d => d.name === name);
        } else {
          item = data.equipment.find(d => d.name === name);
        }

        if (item) {
          modalImg.src = `images/${type}/${item.image}`;
          modalTitle.textContent = item.name;
          modalDesc.textContent = item.short || "";
          modalDetails.innerHTML = `
            ${item.base ? `<strong>Base:</strong> ${item.base}<br>` : ""}
            ${item.glass ? `<strong>Glass:</strong> ${item.glass}<br>` : ""}
            ${item.ingredients ? `<strong>Ingredients:</strong> ${item.ingredients.join(", ")}<br>` : ""}
            ${item.kegged ? `<strong>Kegged:</strong> ${item.kegged}` : ""}
          `;
          modal.style.display = "flex";
        }
      }
    });

    // Close modal
    closeBtn.onclick = () => modal.style.display = "none";
    window.onclick = e => { if (e.target === modal) modal.style.display = "none"; };

    // Favourites
    const favourites = [];
    document.body.addEventListener("click", function(e) {
      if (e.target.classList.contains("fav-btn")) {
        const card = e.target.closest(".card");
        const type = card.getAttribute("data-type");
        const name = card.getAttribute("data-name");

        if (!favourites.includes(name)) {
          favourites.push(name);
          alert(`${name} added to favourites!`);
        }
      }
    });

  } catch (err) {
    console.error("Error loading listings:", err);
  }
}
loadListings();
</script>
</body>
</html>
