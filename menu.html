<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Design Your Menu - GBS9</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="js/header.js" defer></script>
</head>
<body>
  <header id="site-header"></header>

  
<main>
  <h1>Design Your Menu</h1>
  <p style="text-align:center; margin-bottom:1rem; color:#ddd;">
    Swipe left ‚ùå to skip, swipe right ‚ù§Ô∏è to save, or use the buttons below.
  </p>

  <div id="cardStack"></div>
  <div class="buttons">
    <button onclick="dislikeCard()">‚ùå Dislike</button>
    <button onclick="likeCard()">‚úÖ Like</button>
  </div>

  <!-- Tabs -->
  <section id="results" style="margin-top:3rem;">
    <div class="tabs">
      <button class="tab-btn active" data-tab="matched">Matched Menu</button>
      <button class="tab-btn" data-tab="favourites">Favourites</button>
    </div>
    <div class="tab-content" id="matched"></div>
    <div class="tab-content" id="favourites" style="display:none;"></div>
  </section>
</main>

<!-- Hammer.js for swipe -->
<script src="https://hammerjs.github.io/dist/hammer.min.js"></script>
<script>
  let cocktails = [];
  let currentIndex = 0;
  let matchedMenu = [];
  let favourites = [];

  async function loadCocktails() {
    try {
      const res = await fetch("data/cocktails.json");
      cocktails = await res.json();
      renderCard();
    } catch (err) {
      console.error("Error loading cocktails.json", err);
    }
  }

  function renderCard() {
    const stack = document.getElementById("cardStack");
    stack.innerHTML = "";
    if (currentIndex < cocktails.length) {
      const drink = cocktails[currentIndex];
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <img src="images/cocktails/${drink.image}" alt="${drink.name}">
        <h2>${drink.name}</h2>
        <p>${drink.short}</p>
      `;
      stack.appendChild(card);

      // Attach swipe gestures
      const hammer = new Hammer(card);
      hammer.on("swipeleft", () => dislikeCard());
      hammer.on("swiperight", () => likeCard());
    } else {
      stack.innerHTML = "<p>üéâ You've gone through all cocktails!</p>";
    }
  }

  function likeCard() {
    if (currentIndex < cocktails.length) {
      matchedMenu.push(cocktails[currentIndex]);
      updateMatchedMenu();
      currentIndex++;
      renderCard();
    }
  }

  function dislikeCard() {
    if (currentIndex < cocktails.length) {
      currentIndex++;
      renderCard();
    }
  }

  function addToFavourites(drink) {
    if (!favourites.some(f => f.name === drink.name)) {
      favourites.push(drink);
      updateFavourites();
    }
  }

  function updateMatchedMenu() {
    const container = document.getElementById("matched");
    container.innerHTML = matchedMenu.map(d => `
      <div class="menu-item">
        <img src="images/cocktails/${d.image}" alt="${d.name}">
        <div>
          <span>${d.name}</span>
          <small>${d.short}</small>
        </div>
        <button onclick='addToFavourites(${JSON.stringify(d)})'>‚ù§Ô∏è</button>
      </div>
    `).join("");
  }

  function updateFavourites() {
    const container = document.getElementById("favourites");
    container.innerHTML = favourites.map(d => `
      <div class="menu-item">
        <img src="images/cocktails/${d.image}" alt="${d.name}">
        <div>
          <span>${d.name}</span>
          <small>${d.short}</small>
        </div>
      </div>
    `).join("");
  }

  // Tabs
  document.querySelectorAll(".tab-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
      btn.classList.add("active");

      document.querySelectorAll(".tab-content").forEach(tab => tab.style.display = "none");
      document.getElementById(btn.dataset.tab).style.display = "block";
    });
  });

  loadCocktails();
</script>
